<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>term-capture viewer (offline)</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <header class="topbar">
      <div class="title">
        <div class="name">term-capture viewer</div>
        <div class="sub">offline playback from <code>&lt;prefix&gt;.output</code> (+ TCAP sidecars when available)</div>
      </div>

      <div class="controls">
        <label class="field">
          <span>Base</span>
          <input id="baseUrl" type="text" value="../" />
        </label>

        <div class="buttons">
          <button id="scan">Scan</button>
        </div>

        <label class="field">
          <span>Output</span>
          <select id="outputSelect"></select>
        </label>

        <label class="field">
          <span>Input</span>
          <select id="inputSelect"></select>
        </label>

        <label class="field">
          <span>Tail</span>
          <input id="tailBytes" type="number" min="0" step="4096" value="0" />
        </label>

        <label class="field">
          <span>Frame Cap</span>
          <input id="chunkBytes" type="number" min="1024" step="1024" value="4096" />
        </label>

        <label class="field">
          <span>Rate (B/s)</span>
          <input id="rateBps" type="number" min="0" step="100" value="50000" list="ratePresets" />
          <datalist id="ratePresets">
            <option value="1"></option>
            <option value="10"></option>
            <option value="400"></option>
            <option value="1200"></option>
            <option value="50000"></option>
            <option value="400000"></option>
            <option value="0"></option>
          </datalist>
        </label>

        <div class="buttons">
          <button id="play" disabled>Play</button>
          <button id="pause" disabled>Pause</button>
          <button id="reset" disabled>Reset</button>
        </div>
      </div>
    </header>

    <main class="main">
      <section class="panel">
        <div class="hint">
          <div class="hint-title">Quick start</div>
          <ol>
            <li>Run <code>./term-capture mylog</code> and use the shell as normal.</li>
            <li>Serve the repo dir: <code>cd .. &amp;&amp; python3 -m http.server 7878</code></li>
            <li>Open <code>/web/</code> and click Scan to find <code>mylog.output</code>.</li>
          </ol>
          <p>
            If you vendor xterm.js at <code>web/vendor/xterm/xterm.js</code> and
            <code>web/vendor/xterm/xterm.css</code>, this page will render ANSI properly.
            Without it, youâ€™ll see a basic text fallback.
          </p>
        </div>

        <div class="status" id="status">No file loaded.</div>
        <div class="hint" style="margin-top: 10px">
          <div class="hint-title">Local files</div>
          <p>
            Choose a local file to load immediately (no server needed):
          </p>
          <div style="display:flex; gap:10px; flex-wrap:wrap">
            <label class="file">
              <input id="fileOutput" type="file" />
              <span>Choose <code>.output</code></span>
            </label>
            <label class="file">
              <input id="fileInput" type="file" />
              <span>Choose <code>.input</code></span>
            </label>
          </div>
        </div>
      </section>

      <section class="terminal-wrap">
        <div class="terminal-header">
          <div class="terminal-title">Output</div>
          <div class="terminal-meta" id="meta"></div>
        </div>
        <div class="scrubber">
          <input id="timeScrub" type="range" min="0" max="0" value="0" step="1" disabled />
          <div class="scrub-meta" id="timeScrubText">t=?</div>
        </div>
        <div id="terminalStage" class="terminal-stage">
          <div id="terminalCanvas" class="terminal-canvas">
            <div id="terminal" class="terminal"></div>
            <pre id="fallback" class="fallback" hidden></pre>
            <div id="boundsOverlay" class="bounds-overlay" hidden>
              <div id="boundsLabel" class="bounds-label"></div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <script type="module" src="./bootstrap.js"></script>
  </body>
</html>
